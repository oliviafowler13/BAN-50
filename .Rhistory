library(ggplot2)
library(lubridate)
library(zoo)
library(dplyr)
library(knitr)
chicago <- read_csv("~/Spring 2020/BAN 502/Project/chicago.csv")
library(ggplot2)
library(lubridate)
library(zoo)
library(dplyr)
library(knitr)
library(tidyverse)
chicago <- read_csv("~/Spring 2020/BAN 502/Project/chicago.csv")
chicago=chicago%>%mutate(Date = mdy_hms(Date))
chicago = chicago %>% mutate(Hour = hour(Date)) #creates new variable in dataset with the
summary(chicago$Hour) #shows summary of this new variable
chicago = chicago %>% dplyr::select (Date, Hour, Block, IUCR, "Primary Type", Description, Arrest, Domestic, Beat, District, Ward, "Community Area", "FBI Code", "Location Description",Year, Latitude, Longitude)
chicago = chicago %>% mutate(Arrest = as.factor(Arrest)) %>%
mutate(Arrest = fct_recode(Arrest, "False" = "No", "True" = "Yes" )) %>%
mutate(Hour = as.factor(Hour)) %>% mutate(Primary Type = as_factor(as.character(Primary Type)))%>%
chicago=chicago%>%mutate(Date = mdy_hms(Date))
chicago = chicago %>% mutate(Hour = hour(Date)) #creates new variable in dataset with the
summary(chicago$Hour) #shows summary of this new variable
chicago = chicago %>% dplyr::select (Date, Hour, Block, IUCR, "Primary Type", Description, Arrest, Domestic, Beat, District, Ward, "Community Area", "FBI Code", "Location Description",Year, Latitude, Longitude)
chicago = chicago %>% mutate(Arrest = as.factor(Arrest)) %>%
mutate(Arrest = fct_recode(Arrest, False = "No", True = "Yes" )) %>%
mutate(Hour = as.factor(Hour)) %>% mutate(Primary Type = as_factor(as.character(Primary Type)))%>%
chicago=chicago%>%mutate(Date = mdy_hms(Date))
chicago = chicago %>% mutate(Hour = hour(Date)) #creates new variable in dataset with the
summary(chicago$Hour) #shows summary of this new variable
chicago = chicago %>% dplyr::select (Date, Hour, Block, IUCR, "Primary Type", Description, Arrest, Domestic, Beat, District, Ward, "Community Area", "FBI Code", "Location Description",Year, Latitude, Longitude)
chicago = chicago %>% mutate('Arrest' = as.factor('Arrest')) %>%
mutate('Arrest' = fct_recode('Arrest', "False" = "No", "True" = "Yes" )) %>%
mutate('Hour' = as.factor('Hour')) %>% mutate(Primary Type = as_factor(as.character(Primary Type)))%>%
chicago=chicago%>%mutate(Date = mdy_hms(Date))
chicago = chicago %>% mutate(Hour = hour(Date)) #creates new variable in dataset with the
summary(chicago$Hour) #shows summary of this new variable
chicago = chicago %>% dplyr::select (Date, Hour, Block, IUCR, "Primary Type", Description, Arrest, Domestic, Beat, District, Ward, "Community Area", "FBI Code", "Location Description",Year, Latitude, Longitude)
chicago = chicago %>% mutate('Arrest' = as.factor('Arrest')) %>%
mutate('Arrest' = fct_recode('Arrest', "False" = "No", "True" = "Yes" )) %>%
mutate('Hour' = as.factor('Hour')) %>% mutate('Primary Type' = as_factor(as.character('Primary Type')))%>%
mutate('Description' = as.factor('Description'))%>%mutate(Location Description = as_factor(as.character(Location Description))) %>%
chicago = chicago %>% mutate(Hour = hour(Date)) #creates new variable in dataset with the
summary(chicago$Hour) #shows summary of this new variable
chicago = chicago %>% dplyr::select (Date, Hour, Block, IUCR, "Primary Type", Description, Arrest, Domestic, Beat, District, Ward, "Community Area", "FBI Code", "Location Description",Year, Latitude, Longitude)
chicago = chicago %>% mutate(Arrest = as.factor(Arrest)) %>%
mutate(Arrest = fct_recode(Arrest, "False" = "No", "True" = "Yes" )) %>%
mutate(Hour = as.factor(Hour)) %>% mutate('Primary Type' = as_factor(as.character('Primary Type')))%>%
mutate(Description = as.factor(Description))%>%mutate(Location Description = as_factor(as.character(Location Description))) %>%
chicago = chicago %>% mutate(Hour = hour(Date)) #creates new variable in dataset with the
summary(chicago$Hour) #shows summary of this new variable
chicago = chicago %>% dplyr::select (Date, Hour, Block, IUCR, "Primary Type", Description, Arrest, Domestic, Beat, District, Ward, "Community Area", "FBI Code", "Location Description",Year, Latitude, Longitude)
chicago = chicago %>% mutate(Arrest = as.factor(Arrest)) %>%
mutate(Arrest = fct_recode(Arrest, "False" = "No", "True" = "Yes" )) %>%
mutate(Hour = as.factor(Hour)) %>% mutate('Primary Type' = as_factor(as.character('Primary Type')))%>%
mutate(Description = as.factor(Description))%>%mutate('Location Description' = as_factor(as.character('Location Description'))) %>%
mutate(Domestic = as.factor(Domestic))%>%
mutate(District = as.factor(District))%>%
mutate(Year = as.factor(Year))%>%
mutate(Ward = as.factor(Ward))%>%mutate(Community Area = as_factor(as.character(Community Area)))%>%mutate(Block = as.factor(Block))%>%mutate(IUCR = as.factor(IUCR))
chicago = chicago %>% mutate(Hour = hour(Date)) #creates new variable in dataset with the
summary(chicago$Hour) #shows summary of this new variable
chicago = chicago %>% dplyr::select (Date, Hour, Block, IUCR, "Primary Type", Description, Arrest, Domestic, Beat, District, Ward, "Community Area", "FBI Code", "Location Description",Year, Latitude, Longitude)
chicago = chicago %>% mutate(Arrest = as.factor(Arrest)) %>%
mutate(Arrest = fct_recode(Arrest, "False" = "No", "True" = "Yes" )) %>%
mutate(Hour = as.factor(Hour)) %>% mutate('Primary Type' = as_factor(as.character('Primary Type')))%>%
mutate(Description = as.factor(Description))%>%mutate('Location Description' = as_factor(as.character('Location Description'))) %>%
mutate(Domestic = as.factor(Domestic))%>%
mutate(District = as.factor(District))%>%
mutate(Year = as.factor(Year))%>%
mutate(Ward = as.factor(Ward))%>%mutate('Community Area' = as_factor(as.character('Community Area')))%>%mutate(Block = as.factor(Block))%>%mutate(IUCR = as.factor(IUCR))
str(chicago)
chicago=chicago%>%mutate(Date = mdy_hms(Date))
str(chicago)
View(chicago)
View(chicago)
chicago=chicago%>%mutate(Hour = minute(date))
chicago <- read_csv("~/Spring 2020/BAN 502/Project/chicago.csv")
View(chicago)
chicago=chicago%>mutate(Date = mdy_hms(Date))
chicago=chicago%>mutate(Date = mdy_hms(Date)),
chicago=chicago%>%mutate(Date = mdy_hms(Date)),
chicago=chicago%>%mutate(Date = mdy_hms(Date))
chicago = chicago %>% mutate(Hour = hour(Date)), #creates new variable in dataset with the
chicago=chicago%>%mutate(Date = mdy_hms(Date))
chicago = chicago %>% mutate(Hour = hour(Date)) #creates new variable in dataset with the
summary(chicago$Hour) #shows summary of this new variable
chicago = chicago %>% dplyr::select (Date, Hour, Block, IUCR, "Primary Type", Description, Arrest, Domestic, Beat, District, Ward, "Community Area", "FBI Code", "Location Description",Year, Latitude, Longitude)
chicago = chicago %>% mutate(Arrest = as.factor(Arrest)) %>%
mutate(Arrest = fct_recode(Arrest, "False" = "No", "True" = "Yes" )) %>%
mutate(Hour = as.factor(Hour)) %>% mutate('Primary Type' = as_factor(as.character('Primary Type')))%>%
mutate(Description = as.factor(Description))%>%mutate('Location Description' = as_factor(as.character('Location Description'))) %>%
mutate(Domestic = as.factor(Domestic))%>%
mutate(District = as.factor(District))%>%
mutate(Year = as.factor(Year))%>%
mutate(Ward = as.factor(Ward))%>%mutate('Community Area' = as_factor(as.character('Community Area')))%>%mutate(Block = as.factor(Block))%>%mutate(IUCR = as.factor(IUCR))
str(chicago)
View(chicago)
chicago <- read_csv("~/Spring 2020/BAN 502/Project/chicago.csv")
chicago=chicago%>%mutate(Date = mdy_hms(Date))
View(chicago)
chicago=chicago%>%mutate(Date = mdy_hms(Date))
View(chicago)
chicago = chicago %>% mutate(Hour = hour(Date)) #creates new variable in dataset with the
summary(chicago$Hour) #shows summary of this new variable
chicago = chicago %>% dplyr::select (Date, Hour, Block, IUCR, "Primary Type", Description, Arrest, Domestic, Beat, District, Ward, "Community Area", "FBI Code", "Location Description",Year, Latitude, Longitude)
chicago = chicago %>% mutate(Arrest = as.factor(Arrest)) %>%
mutate(Arrest = fct_recode(Arrest, "False" = "No", "True" = "Yes" )) %>%
mutate(Hour = as.factor(Hour)) %>% mutate('Primary Type' = as_factor(as.character('Primary Type')))%>%
mutate(Description = as.factor(Description))%>%mutate('Location Description' = as_factor(as.character('Location Description'))) %>%
mutate(Domestic = as.factor(Domestic))%>%
mutate(District = as.factor(District))%>%
mutate(Year = as.factor(Year))%>%
mutate(Ward = as.factor(Ward))%>%mutate('Community Area' = as_factor(as.character('Community Area')))%>%mutate(Block = as.factor(Block))%>%mutate(IUCR = as.factor(IUCR))
str(chicago)
chicago <- read_csv("~/Spring 2020/BAN 502/Project/chicago.csv")
chicago=chicago%>%mutate(Date = mdy_hms(Date))
chicago = chicago %>% mutate(Hour = hour(Date)) #creates new variable in dataset with the
summary(chicago$Hour) #shows summary of this new variable
chicago = chicago %>% dplyr::select (Date, Hour, Block, IUCR, "Primary Type", Description, Arrest, Domestic, Beat, District, Ward, "Community Area", "FBI Code", "Location Description",Year, Latitude, Longitude)
chicago = chicago %>% mutate(Arrest = as.factor(Arrest)) %>%
mutate(Arrest = fct_recode(Arrest, "False" = "No", "True" = "Yes" )) %>%
mutate(Hour = as.factor(Hour)) %>% mutate('Primary Type' = as_factor(as.character('Primary Type')))%>%
mutate(Description = as.factor(Description))%>%mutate('Location Description' = as_factor(as.character('Location Description'))) %>%
mutate(Domestic = as.factor(Domestic))%>%
mutate(District = as.factor(District))%>%
mutate(Year = as.factor(Year))%>%
mutate(Ward = as.factor(Ward))%>%mutate('Community Area' = as_factor(as.character('Community Area')))%>%mutate(Block = as.factor(Block))%>%mutate(IUCR = as.factor(IUCR))
str(chicago)
View(chicago)
crime$month <- as.factor(month(crime$Date))
chicago$month <- as.factor(month(chicago$Date))
View(chicago)
chicago$month <- as.factor(month(chicago$Date))
chicago$Month = months(DateConvert)
install.packages("date")
chicago$month <- as.factor(month(chicago$Date))
chicago$Month = months(DateConvert)
DateConvert = as.Date(strptime(Crime$Date, "%m/%d/%y %H:%M"))
DateConvert = as.Date(strptime(chicago$Date, "%m/%d/%y %H:%M"))
chicago$Month = months(DateConvert)
chicago$Weekday = weekdays(DateConvert)
View(chicago)
chicago$day <- as.factor(wday(chicago$Date))
chicago$month <- as.factor(month(chicago$Date))
View(chicago)
chicago <- read_csv("~/Spring 2020/BAN 502/Project/chicago.csv")
chicago$day <- as.factor(wday(chicago$Date))
chicago <- read_csv("~/Spring 2020/BAN 502/Project/chicago.csv")
chicago=chicago%>%mutate(Date = mdy_hms(Date))
chicago = chicago %>% mutate(Hour = hour(Date)) #creates new variable in dataset with the
summary(chicago$Hour) #shows summary of this new variable
chicago = chicago %>% dplyr::select (Date, Hour, Block, IUCR, "Primary Type", Description, Arrest, Domestic, Beat, District, Ward, "Community Area", "FBI Code", "Location Description",Year, Latitude, Longitude)
chicago = chicago %>% mutate(Arrest = as.factor(Arrest)) %>%
mutate(Arrest = fct_recode(Arrest, "False" = "No", "True" = "Yes" )) %>%
mutate(Hour = as.factor(Hour)) %>% mutate('Primary Type' = as_factor(as.character('Primary Type')))%>%
mutate(Description = as.factor(Description))%>%mutate('Location Description' = as_factor(as.character('Location Description'))) %>%
mutate(Domestic = as.factor(Domestic))%>%
mutate(District = as.factor(District))%>%
mutate(Year = as.factor(Year))%>%
mutate(Ward = as.factor(Ward))%>%mutate('Community Area' = as_factor(as.character('Community Area')))%>%mutate(Block = as.factor(Block))%>%mutate(IUCR = as.factor(IUCR))
str(chicago)
chicago$day <- as.factor(wday(chicago$Date))
chicago$month <- as.factor(month(chicago$Date))
summary(chicago)
chicago <- read_csv("~/Spring 2020/BAN 502/Project/chicago.csv")
View(chicago)
chicago=chicago%>%mutate(Date = mdy_hms(Date))
chicago = chicago %>% mutate(Hour = hour(Date)) #creates new variable in dataset with the
summary(chicago$Hour) #shows summary of this new variable
chicago = chicago %>% dplyr::select (Date, Hour, Block, IUCR, "Primary Type", Description, Arrest, Domestic, Beat, District, Ward, "Community Area", "FBI Code", "Location Description",Year, Latitude, Longitude)
chicago = chicago %>% mutate(Arrest = as.factor(Arrest)) %>%
mutate(Arrest = fct_recode(Arrest, "False" = "No", "True" = "Yes" )) %>%
mutate(Hour = as.factor(Hour)) %>% mutate('Primary Type' = as_factor(as.character('Primary Type')))%>%
mutate(Description = as.factor(Description))%>%mutate('Location Description' = as_factor(as.character('Location Description'))) %>%
mutate(Domestic = as.factor(Domestic))%>%
mutate(District = as.factor(District))%>%
mutate(Year = as.factor(Year))%>%
mutate(Ward = as.factor(Ward))%>%mutate('Community Area' = as_factor(as.character('Community Area')))%>%mutate(Block = as.factor(Block))%>%mutate(IUCR = as.factor(IUCR))
str(chicago)
chicago$day <- as.factor(wday(chicago$Date))
chicago$month <- as.factor(month(chicago$Date))
library(tidytext)
library(ggplot2)
library(tidyr)
library(corrplot)
View(chicago)
chicago2 <- chicago %>%
select(Date,Description,Domestic,District,day,month)
cor(chicago2, use="complete.obs", method= "pearson")
chicago2 <- chicago %>%
select(Date,Description,day,month)
cor(chicago2, use="complete.obs", method= "pearson")
chicago2 <- chicago %>%
select(Date,day,month)
cor(chicago2, use="complete.obs", method= "pearson")
chicago2 <- chicago %>%
select(month)
cor(chicago2, use="complete.obs", method= "pearson")
t.test(chicago)
ggplot(chicago,aes(x=month, y=arrest, Color = domestic, fill= domestic)) + ggtitle("Monthly Arrest, Domestic") + theme(axis.text.x = element_text(angle = 90, vjust=0.5)) + scale_y_continuous(name="Arrest", labels = scales::comma) + scale_x_discrete(name ="Month")) + geom_col()
ggplot(chicago,aes(x=month, y=arrest, Color = domestic, fill= domestic)) + ggtitle("Monthly Arrest, Domestic") + theme(axis.text.x = element_text(angle = 90, vjust=0.5)) + scale_y_continuous(name="Arrest", labels = scales::comma) + scale_x_discrete(name ="Month") + geom_col()
ggplot(chicago,aes(x=month, y=arrest, Color = Domestic, fill= Domestic)) + ggtitle("Monthly Arrest, Domestic") + theme(axis.text.x = element_text(angle = 90, vjust=0.5)) + scale_y_continuous(name="Arrest", labels = scales::comma) + scale_x_discrete(name ="Month") + geom_col()
ggplot(chicago,aes(x=month, y=Arrest, Color = Domestic, fill= Domestic)) + ggtitle("Monthly Arrest, Domestic") + theme(axis.text.x = element_text(angle = 90, vjust=0.5)) + scale_y_continuous(name="Arrest", labels = scales::comma) + scale_x_discrete(name ="Month") + geom_col()
ggplot(chicago,aes(x=month, y=Arrest, Color = Domestic, fill= Domestic)) + ggtitle("Monthly Arrest, Domestic") + theme(axis.text.x = element_text(angle = 90, vjust=0.5)) + scale_y_continuous(name="Arrest", labels = scales::comma) + scale_x_continuous(name ="Month") + geom_col()
ggplot(chicago,aes(x=month, y=Arrest, Color = Domestic, fill= Domestic)) + ggtitle("Monthly Arrest, Domestic") + theme(axis.text.x = element_text(angle = 90, vjust=0.5)) + scale_y_discrete(name="Arrest", labels = scales::comma) + scale_x_discrete(name ="Month") + geom_col()
ggplot(chicago,aes(x=month, y=Arrest, Color = Domestic, fill= Domestic)) + ggtitle("Monthly Arrest, Domestic") + geom_col()
ggplot(chicago,aes(x=month, y=Arrest = "TRUE", Color = Domestic, fill= Domestic)) + ggtitle("Monthly Arrest, Domestic") + geom_col()
ggplot(chicago,aes(x=month, y=Arrest = 'TRUE', Color = Domestic, fill= Domestic)) + ggtitle("Monthly Arrest, Domestic") + geom_col()
ggplot(chicago,aes(x=month, y=Arrest, Color = Domestic, fill= Domestic)) + ggtitle("Monthly Arrest, Domestic") + scale_x_discrete(name ="Arrest", limits = c(TRUE) + geom_col()
ggplot(chicago,aes(x=month, y=Arrest)) + ggtitle("Monthly Arrest, Domestic") + geom_col()
ggplot(chicago,aes(x=month, y=Arrest = TRUE)) + ggtitle("Monthly Arrest, Domestic") + geom_col()
library(GGally)
library(ggcorrplot)
ggpairs(chicago)
hist(Crime$Date, breaks=100)
hist(chicago$Date, breaks=100)
hist(chicago$Date, breaks=100) + ggtitle("Wake County Home Sales")
hist(chicago$Date, breaks=100) + title("Hey")
hist(chicago$Date, breaks=100)
table(chicago$Month)
table(chicago$month)
table(chicago$Description)[which.max(table(chicago$Descriptioy))]
table(chicago$Description)[which.max(table(chicago$Description))]
table(chicago$Description)
table(chicago$Description)[which.max(table(chicago$Description))]
table(chicago$Description)[which.min(table(chicago$Description))]
hist(chicago$Description, breaks=100)
hist(chicago$day, breaks=100)
hist(chicago$`FBI Code`, breaks=100)
table(chicago$day)
table(chicago$`FBI Code`)
Days <- table(chicago$day)
hist(Days, breaks=100)
barplot(Days, breaks=100)
barplot(Days)
FBI Code <- table(chicago$`FBI Code`)
FBI Code <- table(chicago$FBI Code)
FBI Code <- table(chicago$"FBI Code")
"FBI Code" <- table(chicago$"FBI Code")
barplot("FBI Code")
table(chicago$"FBI Code")
table(chicago$"Location Description")
ggplot(chicago, aes(x=month, y=district)) + geom_point()
ggplot(chicago, aes(x=month, y=District)) + geom_point()
ggplot(chicago, aes(x=District, y=month)) + geom_point()
ggplot(chicago, aes(x=arrest, y=month)) + geom_point()
ggplot(chicago, aes(x=Arrest, y=month)) + geom_point()
ggplot(chicago, aes(x=Arrest, y=month)) + geom_bar()
ggplot(chicago, aes(x=month, y=Arrest)) + geom_bar()
topcrime = chicago %>%
group_by(Description) %>%
summarise(total = n ()) %>%
distinct() %>%
top_n(10)
topcrime %>%
ggplot(aes(reorder(Description, total), y=total)) +
geom_col(fill = "green") +
geom_label_repel(aes(label = total), size = 3) +
coord_flip() +
labs(title = "Chicago Top 10 Crimes in 2018",
x= "Crime Description",
y= "Total")
topcrime %>%
ggplot(aes(reorder(Description, total), y=total)) +
geom_col(fill = "green") +
coord_flip() +
labs(title = "Chicago Top 10 Crimes in 2018",
x= "Crime Description",
y= "Total")
topblock = chicago %>%
group_by(Block) %>%
summarise(total = n ()) %>%
distinct() %>%
top_n(10)
topblock %>%
ggplot(aes(reorder(Block, total), y=total)) +
geom_col(fill = "red") +
coord_flip() +
labs(title = "Chicago Top 10 Blocks for Crime in 2018",
x= "Block",
y= "Total")
topday = chicago %>%
group_by(day()) %>%
summarise(total = n ()) %>%
distinct() %>%
top_n(10)
topday = chicago %>%
group_by(day) %>%
summarise(total = n ()) %>%
distinct() %>%
top_n(10)
topday = chicago %>%
group_by(day) %>%
summarise(total = n ()) %>%
distinct() %>%
top_n(7)
topday %>%
ggplot(aes(reorder(day, total), y=total)) +
geom_col(fill = "blue") +
coord_flip() +
labs(title = "Chicago Top days for Crime in 2018",
x= "Days",
y= "Total")
topday %>%
ggplot(aes(reorder(day, total), y=total)) +
geom_col(fill = "blue") +
coord_flip() +
labs(title = "Chicago Top Days for Crime in 2018",
x= "Days",
y= "Total")
topDistrict = chicago %>%
group_by(District) %>%
summarise(total = n ()) %>%
distinct() %>%
top_n(7)
topDistrict = chicago %>%
group_by(District) %>%
summarise(total = n ()) %>%
distinct() %>%
top_n(10)
topDistrict %>%
ggplot(aes(reorder(District, total), y=total)) +
geom_col(fill = "purple") +
coord_flip() +
labs(title = "Chicago Top Districts for Crime in 2018",
x= "District",
y= "Total")
